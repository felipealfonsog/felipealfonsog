WATCHOPS / TIMEOPS ‚Äî HOWTO (DISCIPLINA DE TIEMPO UTC(NIST))
===========================================================

Autor: Felipe Alfonso Gonz√°lez - f.alfonso@res-ear.ch
Prop√≥sito: Mantener disciplina de tiempo (time discipline) de reloj de pulsera
           sincronizada con UTC(NIST), publicando telemetr√≠a/estado en el
           GitHub Profile README.

Esta gu√≠a explica:
- Qu√© significa el bloque "TIME DISCIPLINE / SITREP"
- C√≥mo medir (calibrar) el offset de tu reloj vs UTC(NIST)
- C√≥mo mantener el estado GREEN de forma confiable
- Buenas pr√°cticas para medici√≥n de deriva (drift) y correcci√≥n


0) DEFINICIONES (LEE ESTO PRIMERO)
----------------------------------

UTC(NIST)
  Tiempo de referencia at√≥mica mantenido por el NIST (EE.UU.) y servido por NTP.

Offset (segundos)
  Diferencia entre tu reloj y UTC(NIST), expresada en segundos.

  DEFINICI√ìN DEL OFFSET (IMPORTANTE):
    offset_s = (hora_del_reloj) - (hora_UTC(NIST))

  Significado:
    offset positivo (+)  => el reloj est√° ADELANTADO (va m√°s r√°pido)
    offset negativo (-)  => el reloj est√° ATRASADO (va m√°s lento)

Drift / Deriva (segundos/d√≠a)
  Tasa diaria con la que el reloj gana o pierde tiempo.

Tolerancia
  Rango de offset aceptable para considerar el reloj "sincronizado".
  Por defecto: ¬±5 segundos


1) QU√â VES EN GITHUB (EL BLOQUE SITREP)
---------------------------------------

Ejemplo:

TIME DISCIPLINE / SITREP
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
REFERENCE: UTC(NIST) via NTP (time.nist.gov)
UTC(NIST):   2026-01-14 21:46:33Z
LOCAL:       2026-01-14 18:46:33 -0300 (America/Santiago)

RUNNER vs NIST (ref-midpoint): +0.045233 s
NETWORK RTT:                0.097788 s

- Watch: Festina
- Drift (estimated): +0.6000 s/day
- Offset vs UTC(NIST) (estimated now): +2.30 s
- Calibration age: 0.15 days | Samples: 5

STATUS: GREEN ‚úÖ TIME DISCIPLINE: NOMINAL
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Last update: 2026-01-14 21:46:33Z

Qu√© significa cada parte:

A) REFERENCE
  La referencia de tiempo: UTC(NIST) consultado por NTP.

B) UTC(NIST)
  Hora at√≥mica actual en UTC (Zulu).

C) LOCAL
  El mismo instante en hora local: America/Santiago.

D) RUNNER vs NIST (ref-midpoint)
  Esto es el reloj de la m√°quina de GitHub Actions vs NIST.
  Es informaci√≥n de contexto. NO es tu reloj Festina.

E) NETWORK RTT
  Latencia de red hacia el servidor NIST (informaci√≥n).

F) Watch: Festina
  Identidad gen√©rica del reloj (no se expone el modelo).

G) Drift (estimated)
  Deriva/velocidad del reloj en segundos por d√≠a.

H) Offset vs UTC(NIST)
  Diferencia estimada actual entre tu Festina y UTC(NIST).

I) Calibration age / Samples
  Age: cu√°n antigua es la √∫ltima medici√≥n.
  Samples: cu√°ntas mediciones se usaron.

J) STATUS
  Estado operacional:
    GREEN ‚úÖ  : dentro de tolerancia
    YELLOW ‚ö†Ô∏è : degradado
    RED üõë    : fuera de tolerancia
    AMBER üü†  : calibraci√≥n vieja/obsoleta (stale)
    BLUE ‚ÑπÔ∏è   : sin mediciones / esperando calibraci√≥n


2) POR QU√â DEBES ESCRIBIR +2.3 O -2.3 (Y POR QU√â IMPORTA)
----------------------------------------------------------

GitHub Actions no puede leer tu reloj f√≠sico.

Por eso el sistema depende de que T√ö ingreses el offset medido.

Ese offset es lo √∫nico que permite que WatchOps sepa:

- Si tu reloj est√° adelantado o atrasado
- Cu√°ntos segundos exactamente
- C√≥mo cambia ese offset con los d√≠as (drift)

Si pones el signo mal (+ en vez de -), el modelo quedar√° malo.

Por eso debes escribir:
  -2.0, -1.0, +2.0, +3.0, etc.
y no solo ‚Äú2.0‚Äù sin signo.


3) ENTENDER EL SIGNO: CU√ÅNDO PONER "-" VS "+"
---------------------------------------------

Definici√≥n de offset nuevamente:

  offset_s = (hora_del_reloj) - (hora_de_referencia)

Entonces:

A) CU√ÅNDO PONER POSITIVO (+)
----------------------------
Escribe un n√∫mero POSITIVO cuando tu Festina est√° ADELANTADO respecto a UTC(NIST).

Ejemplo:
  UTC(NIST):  12:00:00
  Festina:    12:00:02
  offset = +2

Escribes:
  +2.0

Significa:
  ‚ÄúMi Festina est√° 2 segundos adelantado (va r√°pido).‚Äù

M√°s ejemplos:
  Festina 1 segundo adelantado   => +1.0
  Festina 3 segundos adelantado  => +3.0
  Festina 0.5 s adelantado       => +0.5


B) CU√ÅNDO PONER NEGATIVO (-)
----------------------------
Escribe un n√∫mero NEGATIVO cuando tu Festina est√° ATRASADO respecto a UTC(NIST).

Ejemplo:
  UTC(NIST):  12:00:00
  Festina:    11:59:58
  offset = -2

Escribes:
  -2.0

Significa:
  ‚ÄúMi Festina est√° 2 segundos atrasado (va lento).‚Äù

M√°s ejemplos:
  Festina 1 segundo atrasado  => -1.0
  Festina 3 segundos atrasado => -3.0
  Festina 0.4 s atrasado      => -0.4


4) POR QU√â A VECES PONES -1, LUEGO -2, LUEGO -3 (O +1 ‚Üí +2 ‚Üí +3)
-----------------------------------------------------------------

Esto ocurre por la DERIVA (DRIFT) natural del reloj.

Supongamos que tu Festina va lento (pierde tiempo):

D√≠a 1:
  Festina est√° 1 segundo atrasado
  => -1.0

D√≠a 2:
  Festina ahora est√° 2 segundos atrasado
  => -2.0

D√≠a 3:
  Festina ahora est√° 3 segundos atrasado
  => -3.0

Eso muestra que el reloj pierde tiempo consistentemente.

Si el reloj va r√°pido (gana tiempo):

D√≠a 1:
  +1.0
D√≠a 2:
  +2.0
D√≠a 3:
  +3.0

Eso muestra que el reloj gana tiempo.

Esta secuencia es EXACTAMENTE lo que WatchOps necesita para calcular drift.

Ejemplo de drift:
- D√≠a 1 offset: -1.0
- D√≠a 3 offset: -3.0
Cambio = -3.0 - (-1.0) = -2.0 segundos
Tiempo = 2 d√≠as
Drift = -2.0 / 2 = -1.0 s/d√≠a

Significa:
  ‚ÄúEl reloj pierde 1 segundo por d√≠a.‚Äù


5) PATRONES COMUNES (C√ìMO INTERPRETARLOS)
-----------------------------------------

Patr√≥n A: offsets aumentan (+2 ‚Üí +3 ‚Üí +4)
  - reloj adelantado (r√°pido)
  - gana tiempo
  - drift positivo

Patr√≥n B: offsets disminuyen (-1 ‚Üí -2 ‚Üí -3)
  - reloj atrasado (lento)
  - pierde tiempo
  - drift negativo

Patr√≥n C: offsets estables (+2.1 ‚Üí +2.2 ‚Üí +2.1)
  - reloj estable
  - drift cerca de 0
  - excelente disciplina

Patr√≥n D: cambia de signo (+2 ‚Üí -1)
  - normalmente significa que corregiste el reloj (lo ajustaste)
  - o registraste el signo mal
  - ideal: anotar "corrected" en notes


6) D√ìNDE SE ESCRIBEN LOS DATOS (ARCHIVO CSV)
--------------------------------------------

Archivo:
  watchops/measurements.csv

Header obligatorio:
  epoch,watch,offset_s,source,notes


7) C√ìMO CALIBRAR (MEDIR OFFSET) PASO A PASO
-------------------------------------------

Herramientas de referencia:
- Preferida: https://time.gov/
- Aceptable: https://time.is/

Procedimiento:

PASO 1) Abre el reloj de referencia
  - time.gov o time.is
  - aseg√∫rate que muestre los segundos

PASO 2) Espera un ‚Äúborde limpio‚Äù (recomendado)
  - lo m√°s f√°cil: el segundo 00 (XX:XX:00)

PASO 3) Observa tu Festina exactamente en ese momento

PASO 4) Decide si est√° adelantado o atrasado
  - si tu Festina llega antes al segundo 00 => adelantado => offset positivo (+)
  - si llega despu√©s al segundo 00 => atrasado => offset negativo (-)

PASO 5) Estima la diferencia en segundos
  - Ejemplo: 2 segundos antes => +2.0
  - Ejemplo: 1 segundo despu√©s => -1.0

PASO 6) Registra la medici√≥n en GitHub
  Edita:
    watchops/measurements.csv
  Agrega una l√≠nea:
    NOW,Festina,+2.3,time.gov,manual check

PASO 7) Corre el workflow
  GitHub -> Actions -> workflow -> Run workflow


8) QU√â ESCRIBIR EN measurements.csv (EXACTO)
--------------------------------------------

Recomendado (para GitHub):
- Usa epoch = NOW

Ejemplo:

epoch,watch,offset_s,source,notes
NOW,Festina,+2.3,time.gov,manual check #1
NOW,Festina,+2.9,time.gov,manual check #2


Explicaci√≥n de cada campo:

epoch
  Usa NOW.
  Motivo: no necesitas terminal ni convertidores.

watch
  Usa Festina (gen√©rico, sin modelo).

offset_s
  Offset con signo:
    + = adelantado
    - = atrasado

source
  time.gov (mejor) o time.is (OK)

notes
  comentario opcional


9) POR QU√â NECESITAS 2+ MEDICIONES
----------------------------------

Con 1 medici√≥n:
- se puede mostrar "√∫ltimo offset conocido"
- no hay drift

Con 2+ mediciones:
- se calcula drift (segundos/d√≠a)
- se puede estimar el offset actual

Mejor pr√°ctica:
- 5+ mediciones => modelo estable


10) C√ìMO CORREGIR EL RELOJ (DEJARLO "SYNCED")
---------------------------------------------

Objetivo:
- llevar offset a 0.0 segundos (o cercano)
- mantener estado GREEN

M√©todo (reloj cuarzo / Festina):

PASO 1) Saca la corona (posici√≥n de ajuste)
PASO 2) Espera el cambio de minuto en la referencia
PASO 3) Ajusta tu reloj para el minuto correcto
PASO 4) Empuja la corona EXACTO cuando la referencia llega a segundo 00

Despu√©s de corregir:
- registra offset cerca de cero

Ejemplo:
NOW,Festina,+0.0,time.gov,corrected


11) C√ìMO MANTENER GREEN SIEMPRE (REGLAS OPERACIONALES)
------------------------------------------------------

Tolerancia por defecto: ¬±5 segundos

Interpretaci√≥n:
- GREEN  si abs(offset) <= 5
- YELLOW si abs(offset) <= 10
- RED    si abs(offset) > 10

Regla operacional recomendada:
- mantener Festina en ¬±2 segundos siempre
- si se acerca a ¬±4, corregir de inmediato

Rutina recomendada:
- registrar medici√≥n cada 2‚Äì7 d√≠as
- registrar inmediatamente despu√©s de corregir


12) EJECUTAR / DISPARAR EL WORKFLOW EN GITHUB
---------------------------------------------

El workflow corre solo por horario (schedule).
Para actualizar ahora:

GitHub -> Actions -> workflow -> Run workflow

Resultado esperado:
- si cambi√≥ el bloque => commit autom√°tico
- si no cambi√≥ => no hay commit


13) TROUBLESHOOTING
-------------------

STATUS BLUE
  - no hay mediciones
  - revisa si existe watchops/measurements.csv y header correcto

STATUS AMBER
  - calibraci√≥n vieja
  - agrega una medici√≥n NOW

STATUS RED
  - offset estimado muy grande
  - corrige el reloj + registra medici√≥n NOW

Drift raro/incorrecto
  - mediciones muy juntas o signo incorrecto
  - separa mediciones 12‚Äì24h
  - revisa:
      + = adelantado
      - = atrasado


FIN DEL DOCUMENTO
